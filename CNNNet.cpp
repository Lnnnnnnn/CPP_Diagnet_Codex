//
// Created by s1805689 on 12/03/2024.
//

#include "CNNNet.h"


void cnn_forward(input_type input[IN_CH], output_type output[OUT_CH]) {
#pragma HLS ARRAY_PARTITION dim=0 type=complete variable=output
#pragma HLS ARRAY_PARTITION dim=0 type=complete variable=input

/*
fc_in Layer
    self.fc_in = nn.Sequential(
        nn.Linear(15, 64),
        nn.ReLU(),
    )
*/


    //---------------------- ----- ----------------------
    //---------------------- FC  1 ---------------------- // checked
    //---------------------- ----- ----------------------

    input_type layer1_out[OUT_FC_1];
    input_type bias1[OUT_FC_1] = { 0.0604, -0.4554, -0.6693, -0.1645, -0.0453,  0.4963, -0.1890, -0.2199,         0.0082,  0.3912, -0.2820,  0.1250,  0.2916, -0.0257,  0.0729, -0.1021,         0.3051, -0.1774, -0.2422, -0.2027, -0.0072, -0.2011,  0.1788, -0.2217,        -0.0492,  0.2049, -0.3574, -0.1343,  0.2040,  0.2024,  0.3943, -0.0810,        -0.2502, -0.7020,  0.2741, -0.3783};
    input_type weights1[IN_HEIGHT_FC_1][IN_WIDTH_FC_1] = {{ 4.6394e-01, -2.8591e-02, -2.2272e-02, -4.2420e-02, -4.5740e-01,         -9.7039e-03,  2.8558e-02,  8.8521e-02, -8.7410e-02, -3.9856e-02,          4.0289e-02,  6.8467e-02,  9.8576e-03,  5.2227e-02, -2.0133e-02},        { 3.5173e-02, -8.0590e-02,  8.5220e-02,  3.0397e-01,  1.9098e-01,         -6.4833e-02, -1.8913e-01, -4.0455e-02, -3.1784e-02, -2.8875e-01,         -4.6189e-02,  2.1279e-01, -2.1718e-01,  7.6090e-02, -9.4286e-04},        { 1.8126e-01, -3.2234e-02,  6.5393e-02,  5.1706e-02, -1.7480e-01,          3.6800e-01,  2.7387e-02, -1.3370e-02,  2.4194e-01, -1.1878e-01,          1.3831e-01,  2.1814e-01, -1.2415e-01, -2.6224e-03,  3.7244e-02},        { 2.3346e-01,  5.1403e-01, -3.2478e-02,  6.2684e-02, -2.2986e-01,         -3.5589e-02, -5.0757e-01,  6.9448e-02,  5.6338e-02, -3.1384e-02,          2.7354e-01, -3.1061e-02,  1.8007e-02, -2.7911e-02,  1.0260e-02},        { 1.8159e-01,  2.6967e-01, -7.4701e-03, -1.0633e-02, -1.8859e-01,         -6.0402e-04, -2.7184e-01, -2.9394e-03, -4.6803e-01,  7.5369e-02,          8.6490e-02,  5.5412e-02,  1.4130e-02,  8.6514e-03, -1.6247e-02},        {-9.8869e-02, -6.7587e-01, -1.4731e-02, -7.0080e-02,  1.0475e-01,          2.6139e-02,  6.7382e-01, -2.5552e-02, -6.7721e-02, -4.6743e-02,         -1.2119e-01, -1.5666e-02,  8.7685e-03, -8.6382e-03, -3.2855e-02},        { 2.3878e-01,  1.3720e-01,  4.9051e-03,  6.2331e-02, -2.3325e-01,         -1.0064e-01, -1.4825e-01,  2.1827e-01,  1.2096e-01,  1.0591e-02,          7.7054e-01,  7.3795e-02,  1.0125e-02, -1.5686e-02, -1.0077e-02},        {-4.6534e-01,  3.0687e-01, -6.0076e-02,  1.3025e-01,  4.7101e-01,         -1.1444e-01, -2.9225e-01,  2.0737e-01,  1.3893e-01,  9.7014e-02,          6.3930e-01,  7.2729e-02,  8.8611e-03, -6.8898e-02,  9.2763e-03},        {-7.1662e-02, -8.8870e-02,  1.3916e-01, -4.4780e-02,  5.5213e-02,          6.2622e-02,  7.6833e-02, -6.4803e-02, -3.9657e-02,  1.9929e-02,         -2.4348e-01, -3.9019e-02, -1.4228e-02,  2.9890e-02,  1.0864e-04},        { 7.8531e-01,  6.4575e-01,  2.2988e-02,  9.4514e-02, -7.8718e-01,          1.3639e-02, -6.4242e-01, -2.3826e-02,  1.0800e-02, -9.8592e-02,         -1.2224e-01, -1.3662e-02, -1.4245e-02, -2.0187e-02,  3.2784e-02},        {-1.4979e-01,  1.4478e-01, -3.2765e-02, -2.4557e-01,  9.1835e-02,         -4.9663e-02, -1.3050e-01, -4.7476e-02,  3.2252e-02, -4.0368e-02,          8.1335e-02, -2.1353e-01,  8.6978e-03,  7.6145e-02, -1.4004e-02},        {-6.4506e-02, -8.5796e-01, -4.2035e-02, -3.5262e-02,  6.0995e-02,          4.9874e-04,  8.5794e-01,  1.1818e-02,  3.2018e-02,  7.3274e-02,          1.6204e-03, -2.7950e-03,  1.3901e-02,  1.4210e-02,  1.2085e-02},        {-5.6103e-01, -3.3069e-01, -1.7881e-01, -1.7558e-01,  5.5789e-01,          6.4732e-04,  3.4867e-01,  5.2903e-02, -1.5829e-02, -1.4050e-01,          6.3046e-02, -6.6635e-02,  3.7666e-02,  4.5555e-02, -4.5324e-02},        {-3.7546e-01,  1.1409e-01, -2.4804e-01,  3.8719e-02,  3.6388e-01,          1.8643e-02, -1.0737e-01, -6.6531e-03,  2.5481e-02,  4.6615e-02,         -1.4305e-01, -1.0320e-01,  1.1417e-01, -5.3371e-02, -1.5614e-02},        {-3.9238e-01,  1.1993e-01, -1.6714e-01,  2.2684e-02,  3.8989e-01,          1.7891e-02, -1.1436e-01, -1.2297e-03,  1.8589e-02,  2.8802e-02,         -5.2759e-02,  3.7931e-02,  7.1113e-02, -4.9154e-02, -3.0527e-02},        { 8.8773e-02,  6.0793e-01,  1.0545e-01,  1.2189e-01, -7.9354e-02,          1.8242e-02, -6.1360e-01,  1.1585e-02,  6.2612e-04,  1.4983e-01,          3.1755e-02,  6.1482e-02, -4.8155e-02,  1.2796e-02,  5.0566e-02},        { 3.8063e-01,  2.4564e-01, -3.2740e-02,  2.5357e-02, -3.7719e-01,          2.2189e-02, -2.4316e-01,  1.8856e-02, -3.2467e-02,  1.1784e-01,          8.4011e-02, -6.3802e-03,  5.9079e-03, -2.0411e-03,  3.0349e-02},        {-1.2821e-02, -1.5804e-01,  5.3854e-02, -2.4333e-01, -3.2091e-04,          8.9840e-03,  1.5364e-01, -2.5030e-02,  6.4899e-02, -3.5346e-02,         -1.2918e-01, -3.9156e-02, -1.4999e-02,  1.1410e-01, -7.0233e-02},        {-5.3033e-02, -2.1305e-02, -2.5337e-02, -1.7340e-01,  7.3764e-02,         -4.7393e-03,  5.6445e-03, -2.3618e-03, -1.8768e-02, -6.6467e-03,          1.0744e-01,  1.5819e-01, -3.0214e-01,  3.8413e-02, -2.8937e-01},        {-9.5393e-02, -3.0149e-01,  1.4590e-01,  5.1413e-02,  1.2728e-01,          1.0483e-01,  2.5012e-01, -1.2670e-02, -4.5868e-03, -3.6845e-01,         -3.2820e-01,  4.0040e-02,  2.7613e-02,  1.0577e-01, -1.3232e-02},        {-1.5913e-01,  3.4531e-01,  9.6726e-02, -1.2721e-02,  1.5946e-01,         -3.5789e-02, -3.3974e-01,  4.9663e-02,  1.1084e-03,  5.4822e-02,          1.5242e-01,  6.6995e-02, -2.5651e-02,  2.4806e-03,  2.5409e-02},        {-2.6275e-01,  1.0000e-01,  8.3529e-02,  1.9928e-03,  2.5785e-01,         -9.5341e-03, -1.1134e-01,  2.7967e-02, -8.4072e-03,  1.8859e-01,          9.4727e-02, -2.5102e-01, -5.0959e-03,  5.5370e-02, -9.0718e-02},        { 7.5106e-01,  3.3725e-01,  5.7508e-02, -4.1182e-03, -7.4910e-01,          8.3900e-03, -3.3716e-01,  2.0382e-03,  7.7215e-03,  8.6024e-03,         -4.4178e-02, -3.0357e-03,  8.8911e-03,  3.5236e-03, -3.2562e-02},        {-1.4619e-01, -3.0050e-01, -7.9126e-02, -9.5478e-02,  1.5242e-01,         -1.1353e-01,  2.9670e-01, -1.9964e-01,  9.1598e-02,  1.1141e-01,          5.0879e-02,  5.7562e-01,  4.3121e-02,  1.5216e-02, -4.6339e-02},        { 1.1574e-01, -6.1541e-02,  1.5887e-01, -2.0642e-01, -1.6040e-01,         -7.4027e-03,  6.1429e-02,  7.2445e-02, -6.9998e-04, -2.4079e-01,         -4.6285e-02, -8.2897e-02,  3.1031e-02,  4.6869e-02, -2.2691e-03},        { 4.8786e-01,  4.2540e-02,  1.6614e-01,  3.2481e-02, -4.8713e-01,         -4.3306e-02, -4.3266e-02, -4.0027e-03, -1.0581e-02, -1.7792e-01,         -2.0969e-02,  7.9705e-03, -3.9233e-02,  5.7113e-03,  3.4274e-02},        {-2.3546e-01, -3.0926e-02,  1.3085e-01, -1.5801e-01,  2.2976e-01,          2.2055e-02,  4.0350e-02, -2.1144e-02,  2.8229e-03,  1.0841e-01,         -2.2190e-01,  6.6164e-02,  3.3286e-02, -9.5008e-02,  2.3383e-02},        { 7.1834e-02,  1.4159e-01, -2.2311e-01,  5.0701e-02, -5.1555e-02,         -6.4586e-02, -1.2101e-01,  2.4728e-02, -5.3625e-02, -2.1257e-02,         -4.2191e-02,  3.6382e-02, -2.9282e-01,  6.1862e-03, -1.4710e-02},        {-5.2775e-01,  5.5126e-01, -4.6188e-02,  1.3786e-02,  5.4095e-01,          1.2323e-02, -5.4225e-01,  4.4139e-03, -6.5367e-03, -6.8634e-02,          6.7598e-03, -6.8546e-03, -2.4139e-02, -2.5428e-04,  1.4811e-02},        {-3.9772e-01,  2.0320e-01, -1.2592e-02,  3.8905e-02,  3.9854e-01,         -4.2153e-02, -1.9955e-01, -7.1680e-02,  5.6055e-02, -1.4332e-02,          1.5391e-02,  2.9839e-01, -1.5442e-02, -1.0077e-02,  1.0605e-03},        { 4.7677e-01,  1.7908e-01,  1.2932e-01, -1.3910e-02, -4.7551e-01,         -6.3808e-02, -1.8641e-01,  1.2865e-02,  3.5287e-02,  8.8836e-02,         -2.8735e-02, -1.9852e-01, -1.1049e-02,  3.9910e-02,  3.8159e-03},        { 1.4578e-01, -2.2434e-01, -2.5090e-02, -7.2217e-03, -1.5377e-01,         -1.2665e-01,  2.2093e-01,  1.4955e-03, -6.9666e-02,  2.2564e-01,         -1.7254e-02, -5.8834e-02,  5.6552e-02, -2.2471e-02, -2.3859e-02},        {-4.4785e-02,  6.4185e-03,  9.8484e-02,  1.5897e-02,  4.6087e-02,          3.2020e-01, -1.9601e-02, -5.0619e-04,  1.9104e-01,  8.8657e-01,          7.9386e-02,  7.9658e-02, -4.5683e-02,  5.5655e-03,  5.2181e-03},        { 1.5031e-02,  2.1779e-01, -6.8671e-02,  3.7840e-02, -2.4550e-02,         -1.5939e-01, -2.3153e-01, -2.9681e-01,  2.2242e-01,  2.4004e-01,          1.0463e-01,  5.8735e-03,  8.6658e-02,  9.7434e-03, -1.3043e-01},        {-7.2848e-01,  5.0985e-01, -7.2509e-02,  6.6151e-02,  7.2775e-01,         -1.8380e-03, -5.1203e-01,  4.1905e-03, -1.1062e-02,  4.3375e-02,         -3.8575e-02, -5.0449e-02,  3.9463e-02, -1.6241e-02, -1.7557e-03},        {-5.9028e-03,  2.3298e-01, -5.2564e-02, -1.2947e-01,  8.5487e-03,         -4.2588e-02, -2.2934e-01, -9.8528e-02,  4.3700e-02, -1.3043e-01,         -1.3305e-01,  2.6537e-01, -2.2073e-03,  2.4877e-02,  7.7442e-02}};
//#pragma HLS ARRAY_PARTITION dim=0 type=complete variable=layer1_out
//#pragma HLS ARRAY_PARTITION dim=0 type=complete variable=bias1
//#pragma HLS ARRAY_PARTITION dim=0 type=complete variable=weights1

    for (int i = 0; i < IN_HEIGHT_FC_1; i++) {
        layer1_out[i] = bias1[i];
        for (int j = 0; j < IN_WIDTH_FC_1; j++) {
            layer1_out[i] += input[j] * weights1[i][j];
        }
        // nn.ReLU()
        if (layer1_out[i] > 0){
            layer1_out[i] = layer1_out[i];
        } else{
            layer1_out[i] = 0;
        }
    }

    //---------------------- ----- ----------------------
    //---------------------- Reshape ---------------------- checked
    //---------------------- ----- ----------------------

    input_type conv1_in[IN_HEIGHT_CNN_1][IN_WIDTH_CNN_1][IN_CH_CNN_1];
//#pragma HLS ARRAY_PARTITION dim=0 type=complete variable=conv1_in
    for (int i = 0; i < IN_HEIGHT_CNN_1; i++)
    {
        for (int j = 0; j < IN_WIDTH_CNN_1; j++)
        {
            for (int k = 0; k < IN_CH_CNN_1; k++)
            {
                conv1_in[i][j][k] = layer1_out[i * IN_WIDTH_CNN_1 + j];
            }
        }
    }

    //---------------------- ----- ----------------------
    //---------------------- Conv1 ----------------------
    //---------------------- ----- ----------------------

    input_type W_CNN_1[KERNEL_HEIGHT_CNN_1][KERNEL_WIDTH_CNN_1][IN_CH_CNN_1][OUT_CH_CNN_1] = {{{{-0.4153, -0.4682,  0.0623,  0.0910}},         {{-0.1208, -0.1242,  0.2100, -0.3575}},         {{ 0.0704,  0.2138,  0.1649, -0.4380}}},        {{{-0.2708,  0.1866,  0.0274,  0.1782}},         {{ 0.1407,  0.4411,  0.0313,  0.3181}},         {{ 0.0322, -0.0125,  0.5208, -0.6050}}},        {{{-0.0329,  0.4214,  0.0368,  0.1234}},         {{ 0.6858,  0.0449, -0.1042, -0.0585}},         {{-0.0664, -0.1472,  0.6595, -0.3339}}}};
    input_type bias_CNN_1[OUT_CH_CNN_1] = {-0.0010,  0.0006,  0.0010, -0.0003};
    input_type conv1_out[OUT_HEIGHT_CNN_1][OUT_WIDTH_CNN_1][OUT_CH_CNN_1];
//#pragma HLS ARRAY_PARTITION dim=0 type=complete variable=W_CNN_1
//#pragma HLS ARRAY_PARTITION dim=0 type=complete variable=bias_CNN_1
//#pragma HLS ARRAY_PARTITION dim=0 type=complete variable=conv1_out
    Conv(IN_CH_CNN_1,IN_HEIGHT_CNN_1,IN_WIDTH_CNN_1,OUT_CH_CNN_1,
         KERNEL_WIDTH_CNN_1,KERNEL_HEIGHT_CNN_1,X_STRIDE_CNN_1,Y_STRIDE_CNN_1,MODE_CNN_1,RELU_EN_CNN_1,
         conv1_in[0][0],W_CNN_1[0][0][0],bias_CNN_1,conv1_out[0][0]);


    input_type pool1_out[OUT_HEIGHT_POOL_1][OUT_WIDTH_POOL_1][IN_CH_POOL_1];
//#pragma HLS ARRAY_PARTITION dim=0 type=complete variable=pool1_out
    Pool(IN_CH_POOL_1 ,IN_HEIGHT_POOL_1 ,IN_WIDTH_POOL_1 ,
         KERNEL_WIDTH_POOL_1 ,KERNEL_HEIGHT_POOL_1 ,MODE_POOL_1 ,
         conv1_out[0][0],pool1_out[0][0]);//mode: 0:MEAN, 1:MIN, 2:MAX

     //---------------------- ----- ----------------------
    //---------------------- attention1.pool1 ----------------------
    //---------------------- ----- ----------------------

    input_type pool2_out[OUT_HEIGHT_POOL_2][OUT_WIDTH_POOL_2][IN_CH_POOL_2];
//#pragma HLS ARRAY_PARTITION dim=0 type=complete variable=pool2_out
    Pool_2(IN_CH_POOL_2 ,IN_HEIGHT_POOL_2 ,IN_WIDTH_POOL_2 ,
           KERNEL_WIDTH_POOL_2 ,KERNEL_HEIGHT_POOL_2 ,MODE_POOL_2 ,
           pool1_out[0][0],pool2_out[0][0]);//mode: 0:MEAN, 1:MIN, 2:MAX


    //---------------------- ----- ----------------------
    //---------------------- attention1.conv1 + relu ----------------------
    //---------------------- ----- ----------------------

    input_type W_CNN_2[KERNEL_HEIGHT_CNN_2][KERNEL_WIDTH_CNN_2][IN_CH_CNN_2][OUT_CH_CNN_2] = {{{{0.5061, 0.5263},          {0.4060, 0.5830},          {0.7096, 0.7121},          {0.3688, 0.4469}}}};
    input_type bias_CNN_2[OUT_CH_CNN_2] = {0,0};
    input_type conv2_out[OUT_HEIGHT_CNN_2][OUT_WIDTH_CNN_2][OUT_CH_CNN_2];
    Conv_2(IN_CH_CNN_2,IN_HEIGHT_CNN_2,IN_WIDTH_CNN_2,OUT_CH_CNN_2,
         KERNEL_WIDTH_CNN_2,KERNEL_HEIGHT_CNN_2,X_STRIDE_CNN_2,Y_STRIDE_CNN_2,MODE_CNN_2,RELU_EN_CNN_2,
           pool2_out[0][0],W_CNN_2[0][0][0],bias_CNN_2,conv2_out[0][0]);

    //---------------------- ----- ----------------------
    //---------------------- attention1.conv2 + sigmoid ----------------------
    //---------------------- ----- ----------------------

    input_type W_CNN_3[KERNEL_HEIGHT_CNN_3][KERNEL_WIDTH_CNN_3][IN_CH_CNN_3][OUT_CH_CNN_3] = {{{{0.5493, 0.3280, 0.3105, 0.7827},          {0.5274, 0.7215, 0.6055, 0.7465}}}};
    input_type bias_CNN_3[OUT_CH_CNN_3] = {0,0,0,0};
    input_type conv3_out[OUT_HEIGHT_CNN_3][OUT_WIDTH_CNN_3][OUT_CH_CNN_3];
    Conv_3(IN_CH_CNN_3,IN_HEIGHT_CNN_3,IN_WIDTH_CNN_3,OUT_CH_CNN_3,
           KERNEL_WIDTH_CNN_3,KERNEL_HEIGHT_CNN_3,X_STRIDE_CNN_3,Y_STRIDE_CNN_3,MODE_CNN_3,RELU_EN_CNN_3,
           conv2_out[0][0],W_CNN_3[0][0][0],bias_CNN_3,conv3_out[0][0]);



    //---------------------- ----- ----------------------
    //---------------------- Expand and Multiplication ----------------------
    //---------------------- ----- ----------------------

    input_type attention_out[OUT_HEIGHT_POOL_1][OUT_WIDTH_POOL_1][IN_CH_POOL_1];


    Expand_and_Multiplication_loop_reg:
    input_type Attention_gain[IN_CH_POOL_1];
    for (int i = 0; i < IN_CH_POOL_1; ++i) {
        Attention_gain[i] = conv3_out[0][0][i] + 1;
    }


    Expand_and_Multiplication_loop:
    for (int k = 0; k < IN_CH_POOL_1; k++)
    {
#pragma HLS PIPELINE off
//#pragma HLS PIPELINE II=1
        for (int i = 0; i < OUT_HEIGHT_POOL_1; i++)
        {
//#pragma HLS UNROLL
            for (int j = 0; j < OUT_WIDTH_POOL_1; j++)
            {
//#pragma HLS UNROLL
                attention_out[i][j][k] = pool1_out[i][j][k] * Attention_gain[k];
            }
        }
    }

    //---------------------- ----- ----------------------
    //---------------------- Reshape for FC2 ----------------------
    //---------------------- ----- ----------------------

    //  [3][3][4] -> 36
    int index = 0;
    input_type layer2_in[IN_FC_2];
    for (int k = 0; k < IN_CH_POOL_1; k++)
    {
        for (int i = 0; i < OUT_HEIGHT_POOL_1; i++)
        {
            for (int j = 0; j < OUT_WIDTH_POOL_1; j++)
            {
                layer2_in [index++] = attention_out[i][j][k];
            }
        }
    }

    //---------------------- ----- ----------------------
    //---------------------- FC  2 ----------------------
    //---------------------- ----- ----------------------

    input_type layer2_out[OUT_FC_2];
    input_type bias2[OUT_FC_2] = {-3.7874e-01,  2.5309e-01,  2.7061e-02, -1.3634e-01, -3.2313e-02,         1.2861e-01,  2.0850e-01, -8.0357e-02, -9.2575e-02, -5.4077e-16,         2.2304e-01,  3.2027e-01, -2.1067e-01, -7.7177e-03, -1.7143e-01,         1.0225e-01,  2.0398e-01, -1.6569e-02,  7.3526e-02,  1.8825e-01,        -1.1363e-01, -1.8972e-02,  4.0421e-01,  1.0937e-01,  2.0883e-03,         3.5220e-40,  3.8310e-01, -1.5911e-01,  7.2213e-02,  2.0816e-01,         2.6192e-01, -6.3902e-02};
    input_type weights2[IN_HEIGHT_FC_2][IN_WIDTH_FC_2] = {{-3.2451e-01,  6.9482e-02, -3.7592e-01,  1.6819e-02, -4.7317e-02,         -2.1694e-01, -1.4603e-01,  3.7139e-01,  3.6566e-01, -1.5865e-01,          1.5338e-01, -1.8049e-01, -1.8144e-01,  3.8541e-01,  3.8376e-02,         -3.6702e-01,  1.5530e-01,  2.8859e-01,  1.7984e-01,  2.4778e-01,         -5.6975e-01,  3.1530e-01, -3.6584e-02,  7.2181e-02, -2.2343e-01,          7.7316e-01, -7.5021e-02, -3.5049e-01, -1.0208e+00,  1.1102e-01,          4.3415e-01,  6.4700e-02,  2.0211e-01, -1.0052e-01, -3.8773e-01,         -5.4748e-02},        {-1.5730e-01,  1.5794e-01, -1.7740e-01,  4.9586e-01,  4.4535e-02,          3.2496e-01,  1.3514e-01,  1.6031e-01,  6.0898e-02,  1.4400e-01,          2.7890e-01, -7.0811e-02, -4.4484e-01,  3.1136e-01,  4.0066e-02,         -1.6059e-01,  3.4538e-01,  1.6439e-02,  3.3854e-01,  1.6204e-01,          8.4258e-02, -3.4995e-01,  2.0944e-01, -1.0713e-01,  1.3032e-01,         -9.8910e-02,  2.7700e-01, -5.2873e-01, -9.8197e-02,  5.0369e-02,          4.1348e-01, -3.1534e-01,  2.0820e-01, -3.6119e-01,  6.0850e-02,          1.2276e-01},        {-6.3066e-02,  4.0168e-01, -1.8914e-01, -2.0885e-01,  2.6187e-01,         -5.9038e-01,  8.3218e-02, -6.9539e-02, -5.5174e-02, -1.1012e-01,          2.3773e-03, -6.9625e-02, -2.8616e-01,  2.2077e-01, -2.9802e-01,          2.1581e-01, -1.0224e-01, -8.9660e-02, -2.0379e-01,  6.8697e-02,         -8.5268e-01, -6.5911e-02,  6.4289e-01,  1.5571e-01,  9.0530e-02,          2.1280e-01,  4.0172e-01,  1.4693e-01,  1.0907e+00, -3.3481e-01,          1.7367e-01, -2.7911e-02,  7.3568e-02,  1.6630e-01, -2.6258e-01,          2.4596e-01},        { 1.4922e-01,  1.3243e-02,  2.8935e-02, -8.9963e-02, -1.3487e-01,         -3.3561e-01, -3.0865e-02, -1.1858e-01, -2.4326e-01,  3.9396e-02,          1.6559e-01, -1.9497e-02,  1.4179e-01,  3.8431e-01,  5.9596e-02,          2.4700e-01, -1.3488e-01, -2.2330e-01, -9.5202e-02,  1.3319e-01,         -4.7513e-01,  1.1427e-02,  7.7345e-01,  9.9138e-02,  8.3787e-02,         -4.2236e-03,  1.4919e-01,  2.9154e-01, -1.0627e-02, -3.0885e-01,         -1.8125e-02, -5.4488e-02, -5.4177e-03, -1.2320e-01,  3.7658e-01,         -5.4062e-02},        { 1.0660e-01, -2.1351e-01,  4.5244e-01,  1.2530e-02,  3.6386e-02,         -2.6700e-02, -1.9136e-01, -6.4061e-02,  3.6687e-01,  1.3406e-01,         -7.7748e-03,  3.3561e-02,  5.7082e-01, -5.2926e-02,  1.5940e-01,          1.0340e-01, -8.6297e-02,  1.2956e-01, -2.0597e-01, -6.7694e-02,          2.4913e-01, -8.3612e-02, -4.3420e-01,  7.5312e-03,  4.7002e-02,          2.9124e-01, -2.8067e-02,  3.2663e-01,  4.1499e-01, -2.4474e-02,         -5.8182e-03,  3.4151e-01, -1.1219e-01,  2.4395e-01,  1.9515e-01,          2.1764e-01},        { 2.5304e-01, -2.6900e-02,  9.9131e-02,  2.9706e-01, -2.7402e-02,         -1.2566e-01,  3.5920e-01,  3.1134e-01, -1.8796e-01,  1.3788e-01,         -2.8011e-01, -1.5270e-01, -2.0228e-02, -3.9153e-01, -8.8520e-02,          1.8843e-01,  3.1695e-01, -2.1938e-01, -1.8725e-01,  1.6108e-01,          4.0266e-02, -2.9480e-02,  3.7654e-01,  1.1195e-01, -1.0321e-02,         -3.6163e-01,  3.4815e-02, -8.4074e-02,  8.0904e-01, -1.6775e-01,         -5.5522e-01, -1.6633e-01, -2.9350e-02, -1.4567e-01,  1.4925e-01,         -3.2219e-01},        {-7.7967e-02, -2.9450e-01,  3.1913e-01, -3.1217e-01,  1.5194e-01,          1.4896e-01,  6.6375e-02,  3.8332e-01,  8.3400e-01,  8.7888e-02,         -2.2873e-01,  1.9382e-01,  1.2963e-01, -9.4036e-02, -4.8990e-02,         -1.9158e-01, -4.9654e-01,  2.8150e-01,  1.2874e-01, -1.7484e-01,          2.5790e-01,  7.9982e-02, -5.1027e-01, -6.9519e-02, -9.4224e-02,          6.7779e-01,  3.3272e-02, -2.3705e-01,  1.0790e+00, -1.3892e-01,          3.1001e-02, -2.6774e-01, -2.3725e-01, -2.2569e-01,  9.6375e-02,          1.0564e-01},        { 7.8151e-02, -1.7440e-02,  2.9829e-01,  3.9119e-03, -3.6921e-01,          2.0794e-01,  1.2698e-01, -2.6611e-01, -6.2843e-01,  3.6634e-01,         -1.1434e-01,  1.7820e-01,  6.6426e-02,  3.1940e-01, -4.0162e-02,          1.0939e-01, -2.4155e-02, -6.2301e-01, -3.8790e-01, -1.8056e-01,          4.9151e-01, -1.2019e-01, -5.2621e-02, -3.0235e-02,  1.4061e-01,         -9.1118e-01, -2.1855e-02,  5.2384e-01,  7.6967e-01, -1.3579e-01,         -2.2405e-01, -7.9350e-03, -2.9138e-01,  3.3139e-01,  1.8672e-01,         -2.2666e-01},        { 2.2076e-01,  3.6249e-01,  9.0351e-02,  2.1575e-01, -5.8426e-02,         -2.8629e-01,  7.6094e-02,  2.8030e-01, -1.2391e-02,  2.7721e-01,         -1.0151e-01, -2.0833e-01,  2.4468e-01, -1.3264e-01, -7.9736e-02,          1.3640e-01, -3.8774e-01,  2.6537e-01, -2.4648e-01,  5.9748e-02,          2.9102e-01, -2.3500e-01, -3.9614e-01,  3.6723e-01,  3.5306e-02,         -4.4448e-01, -1.8013e-01,  3.0146e-01,  3.3234e-01, -1.6363e-01,         -2.0658e-01,  1.1663e-01, -2.0129e-01, -2.4998e-01,  5.0996e-02,         -1.9130e-01},        {-2.1053e-04, -9.3855e-06, -1.7611e-05, -5.7950e-10, -7.2897e-12,         -8.3799e-07, -3.5475e-05,  3.7204e-06, -5.1111e-06, -3.0632e-06,         -2.0916e-08, -6.7223e-06, -9.8080e-12, -1.8691e-10, -2.5360e-09,         -6.0849e-07,  3.8848e-10, -1.6100e-07, -2.2164e-07, -2.4416e-04,         -1.2141e-04, -3.2867e-06, -2.8768e-04, -4.0176e-04,  5.4907e-05,         -7.5177e-05, -5.4322e-07, -3.9612e-05, -1.5774e-13, -3.5886e-05,         -2.9236e-13, -2.9458e-12, -4.0517e-05, -9.6017e-09, -2.9497e-06,         -5.9119e-06},        { 1.8859e-01, -1.2859e-01,  6.0963e-02, -1.8556e-02,  3.3587e-01,         -2.2885e-01, -1.6760e-01,  1.6106e-01, -9.8936e-02, -1.0905e-01,          6.3875e-02,  4.6850e-02,  1.6117e-01,  9.3825e-02,  3.1107e-01,         -1.0930e-01,  1.3990e-01, -6.3345e-02, -1.1798e-01, -5.5509e-02,         -7.3663e-02, -6.3578e-02,  1.2712e-01, -1.9072e-01, -2.7714e-01,          1.9114e-01, -1.4605e+00,  1.0982e-01,  2.2179e-01,  2.0181e-01,          5.2957e-01,  2.3775e-01, -1.8000e-01,  1.9573e-01,  3.3259e-01,          5.2846e-01},        { 6.5866e-03, -1.7141e-01,  3.1451e-01, -7.0460e-02,  6.8483e-02,          1.4035e-01,  2.5749e-02, -1.4211e-01,  3.4648e-02,  2.8893e-01,         -2.1518e-01, -2.3106e-02, -4.9729e-02, -2.2711e-01,  2.7342e-01,         -3.0569e-01,  9.9249e-02,  3.0011e-01, -1.1788e-01, -2.9631e-01,          6.3505e-01,  1.6506e-01, -6.0872e-01, -1.3818e-01,  1.1260e-02,          3.3816e-02, -1.6675e-01,  9.3331e-02, -5.6335e-01,  4.3410e-01,         -9.2652e-02,  2.6559e-01,  2.0003e-01, -2.5400e-01,  4.1311e-01,          8.9914e-02},        { 2.7606e-01,  3.0393e-01, -2.0969e-01,  2.7534e-01, -4.7044e-01,          6.1870e-03, -3.4302e-02, -4.4983e-02,  2.8791e-01, -1.3726e-01,          6.8998e-02, -1.4363e-01,  6.5069e-01,  5.9498e-02, -2.4431e-02,         -9.6294e-02,  1.8560e-01,  2.7792e-01,  5.0256e-02,  4.9011e-01,         -8.5998e-01, -2.2195e-02,  1.5811e-01,  1.2286e-01, -1.0260e-02,          4.3249e-01, -6.0097e-02,  1.4555e-02,  6.9693e-01, -3.0367e-01,         -3.3006e-01, -2.5866e-01,  8.4625e-02,  2.7184e-03, -2.0461e-01,         -2.0717e-02},        { 2.8324e-02, -1.9112e-01,  3.9075e-01, -9.9154e-02,  5.7686e-02,          8.3326e-03, -2.5500e-01, -1.7899e-01,  4.0066e-01, -2.8118e-01,          5.9724e-02,  2.3605e-03, -3.4470e-01, -2.0480e-01, -5.6398e-02,          3.8252e-02,  1.6396e-01,  4.3720e-01, -1.0153e-01, -1.9304e-01,          9.9266e-02,  2.2250e-01, -4.5694e-01,  1.9963e-01,  7.3344e-02,          4.4129e-01, -5.6966e-02,  1.9051e-01, -7.3724e-01,  2.9787e-01,          1.8040e-01,  1.3692e-01,  5.7257e-02, -3.3394e-02,  1.1501e-01,          2.8145e-01},        { 1.1508e-01,  1.7867e-01, -2.7665e-01,  2.1465e-01, -1.3020e-01,          2.3580e-01,  1.9468e-01,  3.8616e-03,  2.7020e-01, -9.9899e-02,         -7.4368e-02,  4.0301e-01, -9.6600e-02,  6.9548e-02,  7.8630e-02,          1.2789e-01, -7.5790e-02,  9.1701e-02,  7.1038e-02,  7.6757e-02,         -4.1623e-01,  3.2099e-02,  2.3387e-01, -3.6560e-01,  1.8797e-01,          1.3581e-01,  3.0361e-01,  5.3392e-03,  9.6035e-01, -1.3448e-02,         -2.3052e-01,  1.6083e-01,  2.5026e-01,  3.5890e-01, -1.7928e-01,         -2.5091e-01},        { 1.1451e-01, -8.8712e-02,  3.3595e-01,  1.1736e-01, -1.8713e-01,         -1.3259e-01,  2.5380e-02, -2.6877e-03, -1.9138e-01,  1.1006e-01,          1.5289e-01,  6.5278e-02,  3.8692e-01,  1.4198e-01,  3.0525e-01,         -8.4238e-02,  1.4129e-02, -7.5088e-02, -6.5340e-02, -1.3033e-01,          6.1763e-01,  4.0914e-02,  1.3728e-01,  8.7419e-02, -1.5637e-02,         -3.8430e-01, -1.3332e-01,  1.1130e-01,  5.3930e-02,  3.5054e-02,          2.2551e-01,  9.2697e-02, -2.4876e-01, -1.5220e-01,  1.2176e-01,         -5.0138e-03},        { 1.3409e-02,  4.0591e-01, -1.6381e-01, -9.5203e-03,  2.9664e-01,          1.3745e-01,  3.7322e-01,  2.7316e-02, -4.4714e-01, -2.8556e-02,          2.6847e-01,  5.8180e-02,  1.0284e-01,  1.2523e-01,  9.9450e-02,          3.7008e-01, -1.2444e-02, -4.9622e-02, -5.4636e-02,  9.6018e-02,          1.0830e-01, -7.9314e-02,  4.6664e-01, -6.5961e-02,  7.6610e-03,         -6.0218e-01,  2.3533e-02,  2.2703e-01, -1.2103e-01,  9.9544e-02,          2.9805e-01,  6.7748e-03,  2.1966e-01,  3.1930e-01,  8.7906e-02,          5.9891e-02},        { 3.5177e-02, -2.5573e-01, -2.1683e-01,  6.2081e-01, -1.4490e-01,          1.6721e-01,  1.8482e-01,  4.5293e-03,  5.8223e-02,  2.6306e-02,         -1.6900e-01,  3.9161e-01,  3.4946e-01,  7.8332e-02,  2.7390e-01,          1.0890e-01,  1.5294e-01, -3.3655e-01, -1.0095e-01, -2.5294e-01,          6.8449e-01,  1.0387e-01, -2.6338e-01, -1.1313e-01,  3.0529e-01,         -1.6666e-01, -2.0351e-01,  1.9826e-01, -7.9556e-02,  2.0718e-01,         -3.5112e-01,  4.4038e-01, -1.3465e-01, -6.6842e-03,  1.5365e-01,         -5.6773e-01},        {-1.1947e-01,  3.9577e-01, -3.0035e-01, -1.5060e-02,  2.1522e-01,          2.6212e-01,  2.1442e-01, -1.8949e-02,  3.0992e-01, -4.0936e-01,          2.6850e-01, -3.7148e-01,  1.8341e-01, -3.0430e-01, -9.1463e-02,         -2.2725e-01, -1.0696e-01, -9.5716e-02, -5.7680e-02,  2.4314e-01,         -5.4641e-01,  7.8426e-02,  4.7930e-01, -2.8498e-02,  4.2810e-02,          7.5380e-02, -2.0886e-01,  1.1279e-01, -5.9740e-01,  1.2614e-01,          2.7314e-01,  1.9605e-01,  2.1067e-01,  2.1045e-01, -3.5327e-01,          7.2969e-02},        { 7.3966e-02,  1.6522e-01, -1.8234e-01, -2.4622e-01, -9.1244e-02,         -2.2900e-01,  2.9117e-01,  2.4018e-01,  2.0877e-02,  2.8725e-01,          2.1814e-03, -2.7430e-01, -1.8807e-01,  1.5412e-01, -1.9821e-02,          1.3182e-01, -1.7956e-01,  1.8343e-01, -3.2568e-02,  7.6823e-02,         -2.0513e-01, -2.6196e-01,  4.7013e-01, -3.7951e-01, -6.4091e-02,          1.2888e-01, -8.8608e-01,  1.9731e-01, -6.6605e-01,  2.8796e-01,          3.0139e-01, -1.1684e-01, -4.0839e-01, -2.0046e-02, -9.6170e-02,          6.8104e-01},        {-1.9166e-01, -4.5447e-01,  1.6942e-01,  3.4956e-01, -1.1699e-01,          1.1966e-01,  2.1549e-02,  1.1416e-01,  2.9787e-01,  3.7997e-01,         -1.1630e-01,  5.6917e-02,  8.9363e-02,  7.5737e-01,  2.0609e-01,         -1.0970e-01,  5.3713e-02,  6.9214e-01,  3.1244e-01, -1.2822e-01,          2.3940e-01, -4.0186e-02, -4.6937e-01, -1.0792e-01, -4.1630e-03,          5.3942e-01, -1.6297e-01, -6.3167e-01,  3.6093e-01,  1.4445e-01,         -2.4447e-02,  1.9913e-01, -6.3084e-03, -4.3486e-01,  1.6098e-01,         -2.8229e-01},        {-1.6543e-02, -2.6390e-02, -2.4856e-02, -2.4174e-02, -2.3415e-02,         -2.6301e-02, -2.4184e-02, -3.8611e-02, -2.2630e-02, -5.3439e-03,         -1.7890e-02, -2.7567e-02, -2.0896e-02, -2.0968e-02, -2.1416e-02,         -1.3779e-02, -3.0389e-02, -2.4162e-02,  6.1222e-03, -2.6316e-02,         -2.7749e-02,  2.7114e-04, -3.2725e-02, -3.4410e-02, -4.0851e-02,         -2.6019e-02, -3.4580e-02, -1.3454e-02, -2.1806e-03, -3.0890e-02,         -3.5012e-02, -4.0722e-03, -3.1083e-02, -2.0376e-02, -3.5667e-02,         -2.3878e-02},        {-2.3481e-01,  4.6980e-01,  2.9932e-01, -1.2551e-01, -1.0568e-01,         -3.2041e-03, -2.5482e-02,  1.9583e-02,  3.1398e-01, -8.5359e-01,          1.2428e-01,  1.0578e-01,  1.5305e-01,  4.8543e-01,  1.0380e-01,         -1.5135e-01, -2.3784e-01, -1.8397e-01, -2.0502e-01, -2.8377e-01,          6.1904e-01, -8.5835e-02,  4.2238e-02, -9.0351e-02, -4.1883e-02,         -2.6602e-01, -7.4837e-02, -4.9959e-01, -1.6713e-01,  2.4397e-01,          2.7347e-01,  1.3280e-01,  1.9694e-01,  2.6909e-01,  1.1194e-01,          3.0697e-01},        { 1.3042e-01,  2.1721e-01, -1.2479e-02,  1.3163e-01,  1.8147e-01,         -2.3282e-01,  1.8041e-02,  3.4164e-02,  5.7302e-01, -1.8867e-01,         -2.2848e-01, -2.3827e-01, -2.1065e-01,  1.3642e-02, -8.6099e-02,          1.0793e-01,  1.3644e-01,  2.4355e-01, -1.0016e-01,  1.0473e-01,         -6.1177e-01, -1.5941e-01,  3.4090e-02,  6.7036e-02,  6.8936e-02,          5.0712e-01,  2.2112e-01, -1.4670e-01,  2.1609e-01, -1.3668e-01,          4.4579e-01, -8.3034e-02,  2.1426e-02,  8.6850e-03,  6.2428e-02,          1.6601e-01},        {-8.0485e-02, -1.1882e-01,  3.6016e-01, -5.0163e-02,  7.9854e-02,         -3.2959e-01, -2.8236e-02, -8.1159e-02, -3.0796e-01, -1.0342e-01,         -1.6235e-02, -7.7623e-02, -5.1010e-01,  2.5204e-01,  1.9412e-01,          1.1968e-01,  3.7600e-01, -8.3070e-01, -6.1954e-02,  1.8764e-01,         -1.2052e-01,  7.6618e-02,  6.9028e-01,  2.8859e-01,  1.0635e-01,         -1.6412e-01, -2.1573e-01,  3.6386e-01, -2.6371e-01,  1.9477e-01,          1.0507e-01,  5.0709e-03,  3.8624e-02, -3.7840e-01,  1.8983e-01,         -1.3900e-01},        {-6.9796e-06, -1.0702e-09, -6.3074e-10, -2.3467e-23, -9.8027e-34,         -8.8063e-15, -3.3942e-09, -9.2277e-10, -2.6106e-10, -2.4911e-08,         -1.3216e-13, -1.6104e-10, -5.5363e-19, -1.5205e-35, -1.3903e-23,         -4.7455e-16, -6.2920e-20, -6.2348e-12, -3.9388e-09, -9.1784e-07,         -2.3824e-08, -4.7790e-10, -1.3199e-06, -1.6737e-05, -1.4211e-08,         -1.1082e-07, -3.7291e-13, -4.3364e-07, -6.2226e-32, -4.2177e-09,          3.5121e-37,  4.5939e-40, -1.0859e-08, -1.2664e-19, -6.2815e-12,         -5.2610e-10},        { 8.4632e-02,  2.5792e-01, -6.2511e-02, -2.6826e-01, -6.8697e-01,         -5.5500e-02,  1.6131e-01,  1.5669e-02,  1.8150e-01,  2.3996e-01,         -3.0368e-01, -5.4468e-02,  5.9075e-01,  4.9824e-01, -6.8554e-01,          2.1062e-01, -1.5353e-01, -1.7900e-01, -4.0908e-01, -2.6815e-01,          2.5355e-01, -2.5678e-01,  1.9735e-01, -1.8231e-01, -1.6288e-03,         -1.1931e-01,  3.4884e-01,  3.4431e-01,  2.1682e-01, -1.7171e-01,          1.8553e-02, -6.1590e-02,  6.0829e-02,  4.0751e-02, -6.4247e-02,          1.8662e-01},        {-8.1394e-02,  2.7777e-01, -2.8916e-01,  1.3812e-01,  2.7488e-01,         -2.3250e-01,  1.8477e-01, -1.5210e-01, -1.9009e-01, -8.6513e-02,          8.5710e-02, -9.9173e-02, -2.2763e-01,  1.6362e-01, -1.5691e-01,          4.4433e-01,  1.6037e-01,  1.5026e-01, -9.1063e-02,  2.3486e-01,         -4.8873e-01,  1.1207e-01,  3.8678e-01,  5.2577e-02,  8.4086e-02,         -2.2118e-01,  2.2827e-01,  3.0179e-01,  1.2797e-02,  4.9788e-02,          2.6844e-01, -1.9699e-01,  2.1524e-01,  4.2046e-01, -1.8482e-02,          2.9542e-01},        { 1.2629e-01,  4.2200e-01,  1.4158e-01,  4.3588e-01, -5.8638e-01,          8.3022e-02, -2.0854e-01, -2.9720e-01, -4.2224e-01, -4.8490e-02,         -8.4755e-02, -1.6216e-01,  1.2050e-01,  1.9714e-01,  3.8297e-02,         -1.8249e-01,  6.0026e-02,  2.5472e-03, -2.2060e-02,  1.2773e-01,         -2.1399e-02, -9.8172e-02,  5.5775e-01, -1.8929e-02,  4.9025e-02,         -6.7629e-01, -8.4791e-02,  1.5455e-01, -5.4796e-02, -1.7592e-01,         -2.9807e-01,  2.8811e-01,  3.9520e-01,  3.7276e-01, -4.5671e-02,         -1.3951e-01},        { 9.8713e-02, -9.0915e-02,  2.2018e-01,  9.6870e-02,  1.2522e-02,          2.2387e-01,  2.4159e-02,  4.7198e-02,  4.3535e-01,  1.5578e-01,         -7.0866e-02,  2.6373e-02,  4.0072e-01, -7.6535e-02,  2.8719e-02,         -6.4417e-02, -1.7781e-01,  2.0722e-01,  1.9355e-01, -1.7046e-02,          4.1082e-01, -2.4132e-02, -7.3726e-01,  8.3721e-02, -1.7042e-02,          1.4390e-01, -4.6038e-03,  1.0392e-03,  1.8130e-01,  2.8578e-01,         -1.1299e-01,  1.9433e-01,  5.3242e-02,  2.8446e-01,  1.4543e-01,          2.0670e-01},        { 9.2299e-02, -2.2816e-01,  2.1415e-01,  1.0798e-01, -1.8271e-01,          8.4114e-02,  3.9978e-02,  4.9061e-02,  8.5375e-02,  9.4795e-02,          1.1562e-01,  4.6996e-02,  2.6129e-01, -4.7586e-02,  1.4801e-01,         -1.1501e-01, -6.9855e-02,  8.8584e-02,  1.5086e-01,  1.6278e-01,          8.1955e-01,  1.9754e-01, -3.9567e-01, -5.4918e-02, -4.5645e-02,          4.5396e-02,  1.1031e-01, -5.9415e-03,  6.2728e-02,  1.5524e-01,          1.2497e-01,  3.6329e-01, -1.5340e-01, -7.2558e-03,  1.3666e-01,          5.3695e-02},        {-9.6047e-02,  1.6828e-01, -2.6511e-01,  9.2015e-02,  5.0374e-01,         -4.3398e-01,  1.5266e-01, -6.1144e-01,  2.6345e-01, -1.7349e-01,         -1.0199e-01, -3.0694e-01,  7.5774e-02, -1.1594e-02, -1.1343e-01,          1.1095e-01, -7.0389e-03,  1.5700e-01, -7.8183e-02,  9.7314e-02,          1.9270e-02,  2.7255e-01, -1.6018e-01,  1.6060e-01, -8.4235e-01,          5.9017e-02,  4.8393e-02,  8.0202e-02,  2.4295e-01,  2.0549e-01,          2.3747e-01, -2.8955e-02,  2.3934e-01,  4.8199e-02,  9.6177e-03,          4.1134e-01}};

    for (int i = 0; i < IN_HEIGHT_FC_2; i++) {
        layer2_out[i] = bias2[i];
        for (int j = 0; j < IN_WIDTH_FC_2; j++) {
            layer2_out[i] += layer2_in[j] * weights2[i][j];
        }

        if (layer2_out[i] > 0){
            layer2_out[i] = layer2_out[i];
        } else{
            layer2_out[i] = 0;
        }
    }

    //---------------------- ----- ----------------------
    //---------------------- FC  3 ----------------------
    //---------------------- ----- ----------------------

    input_type layer3_out[OUT_FC_SIGAMA];
    input_type bias3[OUT_FC_SIGAMA] = {-0.0680, -0.2814,  0.0511,  0.0838,  0.2032,  0.2077};
    input_type weights3[IN_HEIGHT_FC_SIGAMA][IN_WIDTH_FC_SIGAMA] = {{-3.7099e-01,  9.9451e-02, -1.5333e-01,  3.0394e-01, -1.8762e-01,          5.8595e-01,  8.5091e-02,  3.2296e-01, -2.3811e-01, -6.1713e-03,          2.5469e-01,  1.6809e-01,  2.5314e-01,  1.5451e-01, -1.9571e-01,          3.5930e-01, -7.0561e-02, -2.5718e-01,  1.8925e-01, -1.6783e-01,         -3.9231e-02,  2.3680e-02,  1.2684e-01,  1.9798e-02,  4.6308e-01,          3.8388e-05, -5.0566e-01, -2.2502e-01, -3.5446e-02, -4.7005e-01,         -1.4992e-01, -3.3541e-01},        { 2.1154e-01, -4.8345e-01, -3.6506e-01,  3.5098e-01,  3.6915e-01,         -2.4049e-01, -2.4641e-01, -2.1179e-01, -6.8886e-03, -1.7538e-03,          2.8026e-01, -1.1720e-02,  3.6496e-01,  3.9748e-01,  1.1310e-01,         -2.5666e-02, -1.8526e-01,  7.1375e-02,  1.6100e-01, -8.8483e-02,          1.2022e-01, -1.4405e-02, -6.5732e-01,  1.0962e-01,  3.3848e-01,         -2.4929e-07, -2.8233e-01,  2.4705e-01, -7.7267e-02,  7.0600e-02,         -2.5430e-01, -1.8755e-01},        {-3.5186e-01,  1.7483e-02,  7.7463e-02, -2.9466e-01,  5.1219e-02,         -3.3353e-01, -4.0137e-01,  1.9083e-01,  6.1910e-01,  8.6877e-04,         -1.2055e-02, -3.9871e-02,  6.0466e-02,  5.5626e-01, -2.9077e-01,         -1.4045e-01,  1.3723e-02,  4.9050e-02, -4.7805e-01, -4.9508e-01,          7.8516e-02,  5.2820e-03,  1.6251e-01,  1.9031e-01,  3.1428e-01,         -4.2951e-08, -6.2858e-01,  7.6128e-02,  2.8799e-01,  2.4761e-01,          5.9655e-02, -9.6948e-02},        {-1.3015e+00,  2.7058e-01, -8.8075e-01,  3.0112e-01, -3.7721e-01,         -1.9829e-01, -1.8248e-01,  1.1764e+00, -1.7518e-01, -2.2404e-03,          8.6770e-02,  8.6299e-01,  4.1528e-01,  2.0938e-01, -2.2784e-03,         -1.0326e-01,  3.2410e-01, -3.2855e-01,  2.7581e-01, -3.8901e-01,         -2.3666e-01,  1.7433e-02, -3.6414e-02, -5.2152e-03,  3.8232e-02,          9.0802e-05, -9.9415e-02,  5.0701e-01,  3.5769e-01, -4.1326e-01,         -4.8707e-01,  4.9802e-01},        { 1.1354e-01,  1.7790e-01, -7.8855e-01, -1.4400e-02, -5.6571e-03,         -9.9413e-02, -9.1243e-01, -2.9325e-01, -1.1844e-01,  1.2413e-02,          1.2780e-01,  6.8937e-01,  7.3243e-01,  9.8321e-02,  3.9216e-01,         -2.1274e-01, -3.7636e-01, -7.7589e-01,  5.4305e-01, -4.2439e-01,          9.9124e-01, -1.0865e-02,  4.9286e-01,  4.6362e-01,  2.6085e-01,          5.8098e-04, -1.1346e-01,  1.5503e-01, -5.9370e-01, -3.0350e-02,         -2.4633e-01,  5.6992e-02},        {-1.2555e+00,  1.9354e-01,  1.4603e-02, -3.1349e-01,  2.2133e-01,         -1.4570e-01, -1.0999e+00,  1.0588e+00, -3.4231e-01, -1.0744e-02,          5.6004e-01,  3.5690e-02,  1.6691e-01,  2.5048e-01, -5.6240e-01,         -2.3742e-04, -4.1245e-01,  1.0882e-01,  2.3964e-01,  2.4424e-01,          9.6096e-01,  9.8040e-03, -1.1000e-01, -1.2109e-01,  3.4052e-01,         -1.5715e-04,  7.7098e-02, -2.2452e-01, -5.1612e-01,  3.5520e-01,          4.0074e-01, -3.4894e-02}};


    for (int i = 0; i < IN_HEIGHT_FC_SIGAMA; i++) {
        layer3_out[i] = bias3[i];
        for (int j = 0; j < IN_WIDTH_FC_SIGAMA; j++) {
            layer3_out[i] = layer3_out[i] + layer2_out[j] * weights3[i][j];
        }
        output_type constant = 1;
        layer3_out[i] = constant / (1 + hls::exp(ap_fixed<32, 16>(-layer3_out[i])));
//        layer3_out[i] = constant / (1 + exp(-layer3_out[i]));
    }


    input_type dcmp_value = 0.5;

    output_type output_temp[OUT_CH] = {0,0,0,0,0,0};
#pragma HLS ARRAY_PARTITION dim=0 type=complete variable=output_temp

    for (int i = 0; i < OUT_CH; i++) {
//#pragma HLS UNROLL
        if (layer3_out[i] > dcmp_value){
            output_temp[i] = 1 + i;
        } else{
            output_temp[i] = 0 + i;
        }
    }

//    for (int i = 0; i < OUT_CH; ++i) {
//#pragma HLS UNROLL
//        output[i] = layer3_out[i];
//    }
    output[0] = output_temp[0];
    output[1] = output_temp[1];
    output[2] = output_temp[2];
    output[3] = output_temp[3];
    output[4] = output_temp[4];
    output[5] = output_temp[5];
}



